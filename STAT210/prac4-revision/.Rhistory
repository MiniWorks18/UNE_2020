options(digits=6, show.signif.stars=F)
library(lattice)
source("Rfunctions.R")
source("Rfunctions.R")
samara.df <- read.table("samara.txt",header=T)
samaraEDA <- xyplot(Velocity ~ Load|Tree,data=samara.df,layout=c(3,1),
panel=function(x,y){
panel.xyplot(x,y)
panel.lmline(x,y)} )
print(samaraEDA)
samara.df$Tree <-factor(samara.df$Tree)
attach(samara.df)
mod1 <- lm(Tree~Load+Velocity)
help(lm)
mod1 <- lm(Tree~Load*Velocity)
mod1 <- lm(Velocity~Load+Tree)
anova(mod1)
summary(mod1)
plot(mod1)
mod2 <- lm(Velcotiy~Load*Tree)
mod2 <- lm(Veloctiy~Load*Tree)
mod2 <- lm(Velocity~Load*Tree)
mod3 <- lm(Velocity~Load)
mod4 <- lm(Velocity~Tree)
anova(mod1,mod2,mod3,mod4)
anova(mod1,mod2,mod3)
anova(mod2,mod3)
anova(mod1,mod2,mod3)
help("pchisq")
pchisq(-0.04927,df=-4)
pchisq(-0.04927,df=4)
anova(mod2,mod1,mod3)
anova(mod1,mod2,mod3)
anova(mod1,mod2,mod3)
anova(mod1)
anova(mod2)
anova(mod1)
anova(mo31)
anova(mod3)
anova(mod1)
anova(mod2)
anova(mod3)
anova(mod4)
anova(mod1,mod2,mod3)
mod1 <- lm(Velocity~Load*Tree)
mod2 <- lm(Velocity~Load+Tree)
anova(mod1,mod2,mod3)
step(mod1)
# step wise regression: forward
formL <- formula(~ 1)
formU <- formula(~ Load*Tree, data=samara.df)
# in forward selection you are going to add terms
# hence start.model is the simplest model (overall mean but no predictors)
start.model <- lm(Velocity ~1,data=samara.df)
stepf.model <- step(start.model,direction="forward",scope=list(lower=formL,upper=formU))
# Using backwards stepwise
start.model <- lm(velocity~1)
# Using backwards stepwise
start.model <- lm(Velocity~1)
stepb.model <- step(start.model,direction="backward",scope=list(lower=formL,uppder=formU))
# Using backwards stepwise
start.model <- lm(Velocity~Load*Tree)
stepb.model <- step(start.model,direction="backward",scope=list(lower=formL,uppder=formU))
# Using backwards stepwise
start.model <- lm(Velocity~Load*Tree)
stepb.model <- step(start.model,direction="backward",scope=list(lower=formL,uppder=formU))
# Final model: mod1 (interaction model)
finalmod <- lm(Velocity~Load*Tree)
summary(finalmod)
anova(finalmod)
betaCI(finalmod)
